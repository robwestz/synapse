{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "nexus_data_recipe.schema.json",
  "title": "Nexus Data Recipe",
  "description": "Configuration for automated SERP data extraction.",
  "type": "object",
  "required": ["version", "name", "config"],
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Schema version (e.g. 1.0.0)"
    },
    "name": {
      "type": "string",
      "minLength": 3,
      "maxLength": 50,
      "description": "Unique identifier for the recipe"
    },
    "description": {
      "type": "string",
      "maxLength": 200
    },
    "config": {
      "type": "object",
      "required": ["provider", "region", "limit"],
      "properties": {
        "provider": {
          "type": "string",
          "enum": ["ddg", "serper", "mock"],
          "default": "ddg"
        },
        "region": {
          "type": "string",
          "pattern": "^[a-z]{2}-[a-z]{2}$",
          "default": "wt-wt",
          "description": "Region code (e.g. se-sv, us-en)"
        },
        "limit": {
          "type": "integer",
          "minimum": 1,
          "maximum": 100,
          "default": 10
        },
        "filters": {
          "type": "object",
          "properties": {
            "organic_only": { "type": "boolean", "default": false },
            "time_range": { "enum": ["any", "day", "week", "month", "year"] }
          }
        },
        "fields": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["rank", "title", "link", "snippet", "date", "domain", "position"]
          },
          "minItems": 1
        }
      }
    }
  },
  "additionalProperties": false
}